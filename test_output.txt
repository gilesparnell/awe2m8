
> next-app@0.1.0 test:integration
> INTEGRATION_TEST=true jest --selectProjects integration --verbose

Running one project: integration
  console.log
    [dotenv@17.2.3] injecting env (25) from .env.local -- tip: ✅ audit secrets and track compliance: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    DEBUG: Loaded Accounts: { AWE2M8: 'MISSING', TEST: 'MISSING' }

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:49:13)

  console.log
    Number +61468170318 not in AWE2M8, skipping test

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:121:25)

  console.log
    Number +61468170318 not in TEST, skipping

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:159:25)

FAIL integration __tests__/integration/twilio-porting.test.ts
  Integration: Twilio Porting
    API Health Check
      ✓ should respond to port-number endpoint (43 ms)
    Number Listing
      ✕ should list numbers in an account (9 ms)
    Number Porting Sequence
      ✓ should port number from AWE2M8 to TEST (6 ms)
      ✓ should port number back to AWE2M8 (5 ms)
  Regression: Known Bug Fixes
    21649 Bundle Required Error
      ✕ should NOT throw raw 21649 error for AU numbers (6 ms)
    21651 Address Not In Bundle Error
      ✓ should iterate through addresses to find matching one (6 ms)
    Wrong Route Bug
      ✓ should use port-number route, not workflow route (5 ms)

  ● Integration: Twilio Porting › Number Listing › should list numbers in an account

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      94 |             const data = await response.json();
      95 |
    > 96 |             expect(data.success).toBe(true);
         |                                  ^
      97 |             expect(Array.isArray(data.numbers)).toBe(true);
      98 |         });
      99 |     });

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:96:34)

  ● Regression: Known Bug Fixes › 21649 Bundle Required Error › should NOT throw raw 21649 error for AU numbers

    expect(received).toMatch(expected)

    Expected pattern: /bundle|address|regulatory/i
    Received string:  "Missing sourceAccountSid or targetAccountSid"

      198 |             if (!data.success) {
      199 |                 expect(data.error).not.toContain('Bundle required and not provided');
    > 200 |                 expect(data.error).toMatch(/bundle|address|regulatory/i);
          |                                    ^
      201 |             }
      202 |         });
      203 |     });

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:200:36)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 5 passed, 7 total
Snapshots:   0 total
Time:        0.633 s, estimated 1 s
Ran all test suites.
