
> next-app@0.1.0 test:integration
> NODE_ENV=test INTEGRATION_TEST=true jest --selectProjects integration --verbose

Running one project: integration
  console.log
    DEBUG: Loaded Accounts: { AWE2M8: 'MISSING', TEST: 'MISSING' }

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:48:9)

  console.log
    Number +61468170318 not in AWE2M8, skipping test

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:120:25)

  console.log
    Number +61468170318 not in TEST, skipping

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:158:25)

FAIL integration __tests__/integration/twilio-porting.test.ts
  Integration: Twilio Porting
    API Health Check
      ✓ should respond to port-number endpoint (61 ms)
    Number Listing
      ✕ should list numbers in an account (38 ms)
    Number Porting Sequence
      ✓ should port number from AWE2M8 to TEST (40 ms)
      ✓ should port number back to AWE2M8 (50 ms)
  Regression: Known Bug Fixes
    21649 Bundle Required Error
      ✕ should NOT throw raw 21649 error for AU numbers (134 ms)
    21651 Address Not In Bundle Error
      ✓ should iterate through addresses to find matching one (16 ms)
    Wrong Route Bug
      ✓ should use port-number route, not workflow route (31 ms)

  ● Integration: Twilio Porting › Number Listing › should list numbers in an account

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      93 |             const data = await response.json();
      94 |
    > 95 |             expect(data.success).toBe(true);
         |                                  ^
      96 |             expect(Array.isArray(data.numbers)).toBe(true);
      97 |         });
      98 |     });

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:95:34)

  ● Regression: Known Bug Fixes › 21649 Bundle Required Error › should NOT throw raw 21649 error for AU numbers

    expect(received).toMatch(expected)

    Expected pattern: /bundle|address|regulatory/i
    Received string:  "Missing sourceAccountSid or targetAccountSid"

      197 |             if (!data.success) {
      198 |                 expect(data.error).not.toContain('Bundle required and not provided');
    > 199 |                 expect(data.error).toMatch(/bundle|address|regulatory/i);
          |                                    ^
      200 |             }
      201 |         });
      202 |     });

      at Object.<anonymous> (__tests__/integration/twilio-porting.test.ts:199:36)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 5 passed, 7 total
Snapshots:   0 total
Time:        1.064 s
Ran all test suites.
